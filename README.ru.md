# helium-web

## Основные цели эксперимента

* Избавиться от viper.Viper зависимости в инструментах Helium
* Общую структуру конфигурации приложения парсить по своему и любым сторонним инструментом
* Возможность размещать блок конфигурации для воркеров и серверов где угодно в yaml
* Блок конфигурации может быть под любым ключом, а не строго workers, api, pprof, metrics и тп
* Блок конфигурации воркера можно хранить рядом в блоке конфигурации какого либо компонента и в любой вложенности, [пример](#prim_1)
* Блок конфигурации должен быть экспортируемым из инструментов Helium (не создавать самим, просто разместить в нужном месте, [пример](#prim_2)
* Возможность менять движок для воркеров (общий интерфейс)
* Иметь контроль только в одном месте определить всю структуру конфигурации приложения, валидации её и анмаршалинга (app/init.go)
* Чтобы я мог получить блок конфигурации сервера или воркера в любом другом месте приложения, [пример](#prim_3)
* Знать структуру блока конфигурации в любом месте кода приложения (например, можем получить адрес из структуры), [пример](#prim_3)

## <a name="prim_1">Пример #1</a>

```yaml
services:
  myService:
    schedWorker:
      timer: 20s
      immediately: true
```

## <a name="prim_2">Пример #2</a>

```
type Services struct {
	MyService struct {
		SchedWorker workers.Config
	}
}

type Config struct {
	dig.Out

	// ...

	Services Services
}
```

## <a name="prim_3">Пример #3</a>

```
	// ...
    module.New(report),
	// ...

func report(conf Services) *Report {
	// ...

	fmt.Fprintf(w, "run with period '%s'\n", conf.MyService.SchedWorker.Timer)

	// ...
}
```
